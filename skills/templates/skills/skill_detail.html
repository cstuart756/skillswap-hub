{% extends "base.html" %}
{% block title %}{{ skill.title }} | SkillSwap Hub{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-start gap-3 flex-wrap">
  <div>
    <h1 class="h3 mb-2">{{ skill.title }}</h1>
    <p class="text-muted mb-2">
      Offered by <strong>{{ skill.owner.username }}</strong>
      {% if skill.category %} · {{ skill.category.name }}{% endif %}
      · {{ skill.created_at|date:"j M Y, H:i" }}
    </p>
  </div>
</div>

<div class="card mt-3">
  <div class="card-body">
    <h2 class="h5">Description</h2>
    <p class="mb-0">{{ skill.description|linebreaksbr }}</p>
  </div>
</div>

<div class="mt-4">
  <h2 class="h5">Exchange</h2>

  {% if not user.is_authenticated %}
    <div class="alert alert-warning" role="alert">
      Please <a href="{% url 'login' %}">login</a> to request an exchange.
    </div>
  {% else %}
    {% if user.id == skill.owner_id %}
      <div class="alert alert-info" role="alert">You own this skill listing.</div>
    {% else %}
      {% if show_owner_contact and owner_contact %}
        <div class="alert alert-success" role="alert">
          <strong>Contact Details for {{ skill.owner.username }}:</strong><br>
          Name: {{ owner_contact.full_name }}<br>
          Email: <a href="mailto:{{ owner_contact.email }}">{{ owner_contact.email }}</a><br>
          {% if owner_contact.phone %}Phone: {{ owner_contact.phone }}<br>{% endif %}
          {% if owner_contact.notes %}Notes: {{ owner_contact.notes }}<br>{% endif %}
        </div>
      {% else %}
        <form method="post" action="{% url 'exchange_request_create' skill.pk %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-success">Request Exchange</button>
        </form>
      {% endif %}
    {% endif %}
  {% endif %}
</div>
{% endblock %}